NB. in =: 3 4 3 1 2
in =: 1 1 5 2 1 1 5 5 3 1 1 1 1 1 1 3 4 5 2 1 2 1 1 1 1 1 1 1 1 3 1 1 5 4 5 1 5 3 1 3 2 1 1 1 1 2 4 1 5 1 1 1 4 4 1 1 1 1 1 1 3 4 5 1 1 2 1 1 5 1 1 4 1 4 4 2 4 4 2 2 1 2 3 1 1 2 5 3 1 1 1 4 1 2 2 1 4 1 1 2 5 1 3 2 5 2 5 1 1 1 5 3 1 3 1 5 3 3 4 1 1 4 4 1 3 3 2 5 5 1 1 1 1 3 1 5 2 1 3 5 1 4 3 1 3 1 1 3 1 1 1 1 1 1 5 1 1 5 5 2 1 5 1 4 1 1 5 1 1 1 5 5 5 1 4 5 1 3 1 2 5 1 1 1 5 1 1 4 1 1 2 3 1 3 4 1 2 1 4 3 1 2 4 1 5 1 1 1 1 1 3 4 1 1 5 1 1 3 1 1 2 1 3 1 2 1 1 3 3 4 5 3 5 1 1 1 1 1 1 1 1 1 5 4 1 5 1 3 1 1 2 5 1 1 4 1 1 4 4 3 1 2 1 2 4 4 4 1 2 1 3 2 4 4 1 1 1 1 4 1 1 1 1 1 4 1 5 4 1 5 4 1 1 2 5 5 1 1 1 5

counts =: (i.9) +/@:E."(0 _) in

step =: monad define
  zeroed =: 0 { y
  shifted =: 1 |.!.0 y
  modify =: (zeroed, zeroed) (6 8}) 9 $ 0
  shifted + modify
)

p1 =: +/ step^:80 counts
p2 =: +/ step^:256 counts